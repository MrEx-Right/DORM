<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DORM SCANNER</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

    <style>
        /* CORE VARIABLES */
        :root {
            --bg-dark: #0d1117;
            --panel-bg: #161b22;
            --border: #30363d;
            --text-main: #c9d1d9;
            --text-dim: #8b949e;
            --accent: #58a6ff;
            --success: #238636;
            --danger: #da3633;
            --warning: #d29922;
        }
        body { background-color: var(--bg-dark); color: var(--text-main); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* SIDEBAR */
        .sidebar { width: 240px; background: var(--panel-bg); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; flex-shrink: 0; }
        .main-content { flex-grow: 1; padding: 30px; overflow-y: auto; position: relative; }
        .container { max-width: 1200px; margin: 0 auto; }

        /* BRAND */
        .brand { margin-bottom: 40px; text-align: center; }
        .brand h1 { color: var(--accent); letter-spacing: 4px; font-weight: 800; margin: 0; font-size: 28px; }
        .brand span { font-size: 10px; color: var(--text-dim); letter-spacing: 2px; display: block; margin-top: 5px; }

        /* NAVIGATION */
        .nav-item { padding: 12px 15px; margin-bottom: 8px; border-radius: 6px; cursor: pointer; color: var(--text-dim); display: flex; align-items: center; gap: 10px; transition: 0.2s; font-weight: 600; font-size: 14px; }
        .nav-item:hover { background: rgba(88, 166, 255, 0.1); color: var(--accent); }
        .nav-item.active { background: var(--accent); color: #fff; }
        .nav-item i { width: 20px; text-align: center; }

        /* FUZZER PANEL (NEW) */
        .fuzzer-panel {
            margin-top: 20px;
            background: rgba(218, 54, 51, 0.1); /* Light Red */
            border: 1px solid var(--danger);
            border-radius: 8px;
            padding: 15px;
        }
        .fuzzer-header { color: var(--danger); font-size: 11px; font-weight: 800; letter-spacing: 1px; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        .fuzzer-status { font-size: 10px; color: var(--text-dim); margin-top: 5px; display: flex; align-items: center; gap: 5px; }

        /* VIEW & CONTROLS */
        .view-section { display: none; animation: fadeIn 0.3s ease; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .control-panel { background: var(--panel-bg); padding: 20px; border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); display: flex; flex-direction: column; gap: 15px; }
        .input-group { display: flex; gap: 10px; align-items: center; }
        input[type="text"] { flex-grow: 1; padding: 12px; background: var(--bg-dark); border: 1px solid var(--border); color: #fff; border-radius: 6px; font-family: 'Consolas', monospace; outline: none; }
        input[type="text"]:focus { border-color: var(--accent); }
        #timerDisplay { font-family: 'Consolas', monospace; font-size: 20px; color: var(--accent); font-weight: bold; width: 60px; text-align: center; }

        .settings-row { display: flex; align-items: center; gap: 20px; padding: 5px 0; }
        .toggle-label { display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px; font-weight: 600; color: var(--text-main); user-select: none; }
        .toggle-label input { accent-color: var(--accent); width: 16px; height: 16px; }

        /* AUTH */
        .auth-trigger { cursor: pointer; color: var(--text-dim); font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 8px; user-select: none; transition: 0.2s; }
        .auth-trigger:hover { color: var(--accent); }
        .auth-content { display: none; padding-left: 10px; border-left: 2px solid var(--border); margin-top: 5px; animation: slideDown 0.2s ease; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* BUTTONS & PLUGINS */
        button { padding: 12px 25px; background: var(--success); color: white; border: none; cursor: pointer; border-radius: 6px; font-weight: bold; transition: 0.2s; display: flex; align-items: center; gap: 8px; font-size: 13px; }
        button:hover { filter: brightness(1.1); }
        button:disabled { background: var(--border); cursor: not-allowed; opacity: 0.6; }
        .btn-group { display: flex; gap: 10px; justify-content: flex-end; }
        
        /* IMPORTANT: STYLE FOR STOP BUTTON */
        .btn-danger { background: var(--danger) !important; color: white !important; }
        .btn-danger:hover { background-color: #b62324 !important; }
        
        .btn-icon { padding: 8px; aspect-ratio: 1; justify-content: center; }

        #plugin-section { display: none; background: var(--bg-dark); border: 1px solid var(--border); padding: 15px; border-radius: 6px; margin-top: 10px; }
        .plugin-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 8px; max-height: 200px; overflow-y: auto; }
        .plugin-item { display: flex; align-items: center; gap: 8px; padding: 6px; background: #21262d; border-radius: 4px; cursor: pointer; font-size: 12px; border: 1px solid transparent; }
        .plugin-item:hover { border-color: var(--text-dim); }

        /* CHART & TABLES */
        .chart-container { background: var(--panel-bg); padding: 15px; border: 1px solid var(--border); border-radius: 12px; margin-top: 20px; height: 220px; display: flex; justify-content: center; }
        table { width: 100%; margin-top: 20px; border-collapse: separate; border-spacing: 0 5px; }
        th { text-align: left; padding: 12px; color: var(--text-dim); text-transform: uppercase; font-size: 0.85em; letter-spacing: 1px; }
        .vuln-row { background: var(--panel-bg); cursor: pointer; transition: background 0.2s; }
        .vuln-row:hover { background: #21262d; transform: translateX(2px); }
        td { padding: 12px; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); font-size: 14px; }
        td:first-child { border-left: 1px solid var(--border); border-radius: 6px 0 0 6px; }
        td:last-child { border-right: 1px solid var(--border); border-radius: 0 6px 6px 0; }
        
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: bold; color:#000; text-transform: uppercase; display: inline-block; min-width: 60px; text-align: center; }
        .sev-CRITICAL { background: #ff7b72; box-shadow: 0 0 8px rgba(255, 123, 114, 0.4); }
        .sev-HIGH { background: #ff9b5e; }
        .sev-MEDIUM { background: #d29922; }
        .sev-LOW { background: #e3b341; }
        .sev-INFO { background: #58a6ff; }
        .status-running { color: var(--accent); font-weight: bold; animation: pulse 1.5s infinite; }
        .status-completed { color: var(--success); font-weight: bold; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .detail-row { display: none; }
        .detail-content { background: var(--bg-dark); padding: 20px; border: 1px solid var(--border); border-top: none; color: var(--text-dim); margin: 0 10px 10px 10px; border-radius: 0 0 8px 8px; font-size: 13px; line-height: 1.6; }
        .arrow { font-size: 12px; color: var(--accent); transition: transform 0.2s; }
        .vuln-row.open .arrow { transform: rotate(180deg); }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="brand">
            <h1>DORM</h1>
            <span>ENTERPRISE SCANNER</span>
        </div>
        <div class="nav-item active" onclick="switchView('scanner')">
            <i class="fas fa-radar"></i> New Scan
        </div>
        <div class="nav-item" onclick="switchView('history')">
            <i class="fas fa-history"></i> Scan History
        </div>

        <div class="fuzzer-panel">
            <div class="fuzzer-header">
                <i class="fas fa-hammer"></i> FUZZER ENGINE
            </div>
            <label class="toggle-label" style="color:#c9d1d9;">
                <input type="checkbox" id="sidebarFuzzerToggle"> 
                Enable Fuzzing
            </label>
            <div class="fuzzer-status">
                <i class="fas fa-file-alt"></i> payloads/fuzzing.txt
            </div>
        </div>

        <div style="margin-top:auto; font-size:11px; color:#30363d; text-align:center;">
            v1.3.4
        </div>
    </div>

    <div class="main-content">

        <div id="view-scanner" class="view-section active">
            <div class="container">
                <div class="control-panel">
                    <div class="input-group">
                        <input type="text" id="targetInput" placeholder="Target URL or IP (e.g., example.com)">
                        <div id="timerDisplay">00:00</div>
                        <button onclick="startScan()" id="scanBtn"><i class="fas fa-play"></i> START SCAN</button>
                    </div>

                    <div style="margin-top: 15px;">
                        <div class="auth-trigger" onclick="toggleAuth()">
                            <i class="fas fa-chevron-right" id="authArrow"></i> 
                            <i class="fas fa-key"></i> Authentication Options (Optional)
                        </div>
                        <div id="authContainer" class="auth-content">
                            <div class="input-group" style="margin-top:10px;">
                                <input type="text" id="authInput" placeholder='Paste Header e.g. "Cookie: PHPSESSID=xyz..." or "Authorization: Bearer..."' 
                                       style="border-color:var(--border); font-size:13px; color:#aaffaa; font-family:'Consolas';">
                            </div>
                        </div>
                    </div>

                    <div class="settings-row">
                        <label class="toggle-label">
                            <input type="checkbox" id="uaToggle"> 
                            ðŸ¦Ž Chameleon Mode (Rotate User-Agent)
                        </label>
                    </div>
                    
                    <div class="btn-group">
                        <button onclick="togglePlugins()" style="background:#1f6feb"><i class="fas fa-cogs"></i> PLUGINS</button>
                        <button onclick="downloadReport()" style="background:#8957e5"><i class="fas fa-file-code"></i> HTML</button>
                        <button onclick="downloadPDF()" style="background:#da3633"><i class="fas fa-file-pdf"></i> PDF</button>
                    </div>
            
                    <div id="plugin-section">
                        <div class="plugin-grid" id="pluginGrid"></div>
                    </div>
                </div>
            
                <div class="chart-container"><canvas id="vulnChart"></canvas></div>
            
                <table id="resultsTable">
                    <thead>
                        <tr>
                            <th width="100">SEVERITY</th>
                            <th width="60">CVSS</th>
                            <th>VULNERABILITY NAME</th>
                            <th>ENGINE</th>
                            <th>TARGET</th>
                            <th width="30"></th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>

        <div id="view-history" class="view-section">
            <div class="container">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <h2 style="margin:0; color:var(--text-main);">Scan History</h2>
                    <button onclick="loadHistory()" style="background:var(--panel-bg); border:1px solid var(--border); color:var(--text-main);"><i class="fas fa-sync"></i> Refresh</button>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th>STATUS</th>
                            <th>TARGET</th>
                            <th>DATE</th>
                            <th>DURATION</th>
                            <th>TOTAL VULNS</th>
                            <th style="text-align:right">ACTIONS</th>
                        </tr>
                    </thead>
                    <tbody id="historyBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="app.js"></script>

</body>
</html>
